"use strict";
var property_validator_1 = require("./validators/property-validator");
var credit_card_validator_1 = require("./validators/credit-card.validator");
var email_validator_1 = require("./validators/email.validator");
var equal_validator_1 = require("./validators/equal.validator");
var exact_length_validator_1 = require("./validators/exact-length.validator");
var exclusive_between_validator_1 = require("./validators/exclusive-between.validator");
var greater_than_or_equal_validator_1 = require("./validators/greater-than-or-equal.validator");
var greater_than_validator_1 = require("./validators/greater-than.validator");
var inclusive_between_validator_1 = require("./validators/inclusive-between.validator");
var less_than_or_equal_validator_1 = require("./validators/less-than-or-equal.validator");
var less_than_validator_1 = require("./validators/less-than.validator");
var max_length_validator_1 = require("./validators/max-length.validator");
var min_length_validator_1 = require("./validators/min-length.validator");
var not_empty_validator_1 = require("./validators/not-empty.validator");
var not_equal_validator_1 = require("./validators/not-equal.validator");
var not_null_validator_1 = require("./validators/not-null.validator");
var null_validator_1 = require("./validators/null.validator");
var phone_validator_1 = require("./validators/phone.validator");
var predicate_validator_1 = require("./validators/predicate.validator");
var regular_expression_validator_1 = require("./validators/regular-expression.validator");
var uri_validator_1 = require("./validators/uri.validator");
/** Helper class that can be used to configure a validation rule. */
var ValidationRuleConfigurator = (function () {
    /**
     * Initializes a new instance of the ValidationRuleConfigurator class.
     * @param rule Rule to be configured.
     */
    function ValidationRuleConfigurator(rule) {
        this._rule = rule;
    }
    /**
     * Ð¡an be used to specify condition that control when the rule should execute.
     * @param predicate Condition.
     */
    ValidationRuleConfigurator.prototype.when = function (predicate) {
        this._rule.when.push(predicate);
        return this;
    };
    /**
     * Specifies a custom error message to use if validation fails.
     * @param errorMessage The error message to use.
     */
    ValidationRuleConfigurator.prototype.withMessage = function (errorMessage) {
        if (this._rule.propertyValidators.length > 0) {
            this._rule.propertyValidators[this._rule.propertyValidators.length - 1].errorMessage = errorMessage;
            return this;
        }
        throw "Can't set error message: validator list is empty.";
    };
    /**
     * Specifies a custom error message resource to use when validation fails.
     * @param resourceName The resource to use.
     */
    ValidationRuleConfigurator.prototype.withLocalizedMessage = function (resourceName) {
        if (this._rule.propertyValidators.length > 0) {
            this._rule.propertyValidators[this._rule.propertyValidators.length - 1].errorMessageResourceName = resourceName;
            return this;
        }
        throw "Can't set error message: validator list is empty.";
    };
    /**
     * Specifies a custom property name to use within the error message.
     * @param name Custom property name to use.
     */
    ValidationRuleConfigurator.prototype.withName = function (name) {
        this._rule.propertyDisplayName = name;
        return this;
    };
    /**
     * Defines a custom validator on the current rule builder.
     * @param validator Property or object validator instance.
     */
    ValidationRuleConfigurator.prototype.setValidator = function (validator) {
        if (validator instanceof property_validator_1.PropertyValidator) {
            this._rule.propertyValidators.push(validator);
        }
        else {
            this._rule.validators.push(validator);
        }
        return this;
    };
    /**
     * Defines a custom collection validator on the current rule builder.
     * @param validator Object validator to apply.
     */
    ValidationRuleConfigurator.prototype.setCollectionValidator = function (validator) {
        this._rule.collectionValidators.push(validator);
        return this;
    };
    /**
     * Defines a 'credit card' validator on the current rule.
     * Validation will fail if the property is not a credit card number.
     */
    ValidationRuleConfigurator.prototype.creditCard = function () {
        return this.setValidator(new credit_card_validator_1.CreditCardValidator());
    };
    /**
     * Defines an 'email' validator on the current rule.
     * Validation will fail if the property is not an email address.
     */
    ValidationRuleConfigurator.prototype.email = function () {
        return this.setValidator(new email_validator_1.EmailValidator());
    };
    /**
     * Defines an 'empty' validator on the current rule.
     * Validation will fail if the property is not null, not undefined, not whitespace, not zero and not an empty array.
     */
    ValidationRuleConfigurator.prototype.empty = function () {
        return this.setValidator(new not_null_validator_1.NotNullValidator());
    };
    /**
     * Defines an 'equal' validator on the current rule.
     * Validation will fail if the specified value is not equal to the value of the property.
     */
    ValidationRuleConfigurator.prototype.equal = function (valueToCompare) {
        return this.setValidator(new equal_validator_1.EqualValidator(valueToCompare));
    };
    /**
     * Defines an 'exact length' validator on the current rule.
     * Validation will fail if the length of the string is not equal to the length specified.
     * @param length Exact length.
     */
    ValidationRuleConfigurator.prototype.exactLength = function (length) {
        return this.setValidator(new exact_length_validator_1.ExactLengthValidator(length));
    };
    /**
     * Defines a 'exclusive between' validator on the current rule.
     * Validation will fail if the value of the property is outside of the specifed range. The range is exclusive.
     * @param min Minimum value.
     * @param max Maximum value.
     */
    ValidationRuleConfigurator.prototype.exclusiveBetween = function (min, max) {
        return this.setValidator(new exclusive_between_validator_1.ExclusiveBetweenValidator(min, max));
    };
    /**
     * Defines a 'greater than' validator on the current rule.
     * The validation will fail if the property value is less than or equal to the specified value.
     * @param min Minimum value.
     */
    ValidationRuleConfigurator.prototype.greaterThan = function (min) {
        return this.setValidator(new greater_than_validator_1.GreaterThanValidator(min));
    };
    /**
     * Defines a 'greater than or equal' validator on the current rule.
     * The validation will fail if the property value is less than the specified value.
     * @param min Minimum value.
     */
    ValidationRuleConfigurator.prototype.greaterThanOrEqual = function (min) {
        return this.setValidator(new greater_than_or_equal_validator_1.GreaterThanOrEqualValidator(min));
    };
    /**
     * Defines a 'inclusive between' validator on the current rule.
     * Validation will fail if the value of the property is outside of the specifed range. The range is inclusive.
     * @param min Minimum value.
     * @param max Maximum value.
     */
    ValidationRuleConfigurator.prototype.inclusiveBetween = function (min, max) {
        return this.setValidator(new inclusive_between_validator_1.InclusiveBetweenValidator(min, max));
    };
    /**
     * Defines a 'less than' validator on the current rule.
     * The validation will fail if the property value is more than or equal to the specified value.
     * @param max Maximum value.
     */
    ValidationRuleConfigurator.prototype.lessThan = function (max) {
        return this.setValidator(new less_than_validator_1.LessThanValidator(max));
    };
    /**
     * Defines a 'less than or equal' validator on the current rule.
     * The validation will fail if the property value is more than the specified value.
     * @param max Maximum value.
     */
    ValidationRuleConfigurator.prototype.lessThanOrEqual = function (max) {
        return this.setValidator(new less_than_or_equal_validator_1.LessThanOrEqualValidator(max));
    };
    /**
     * Defines a 'maximum length' validator on the current rule.
     * Validation will fail if the length of the string is more than the specified value.
     * @param maxLength Maximum length.
     */
    ValidationRuleConfigurator.prototype.maxLenght = function (maxLength) {
        this.setValidator(new max_length_validator_1.MaxLengthValidator(maxLength));
        return this;
    };
    /**
     * Defines a 'minimum length' validator on the current rule.
     * Validation will fail if the length of the string is less than the specified value.
     * @param maxLength Maximum length.
     */
    ValidationRuleConfigurator.prototype.minLenght = function (minLength) {
        this.setValidator(new min_length_validator_1.MinLengthValidator(minLength));
        return this;
    };
    /**
     * Defines an 'not empty' validator on the current rule.
     * Validation will fail if the property is null, undefined, whitespace, zero or an empty array.
     */
    ValidationRuleConfigurator.prototype.notEmpty = function () {
        return this.setValidator(new not_empty_validator_1.NotEmptyValidator());
    };
    /**
     * Defines a 'not equal' validator on the current rule.
     * Validation will fail if the specified value is equal to the value of the property.
     */
    ValidationRuleConfigurator.prototype.notEqual = function (valueToCompare) {
        return this.setValidator(new not_equal_validator_1.NotEqualValidator(valueToCompare));
    };
    /**
     * Defines a 'not null' validator on the current rule.
     * Validation will fail if the property is null or undefined.
     */
    ValidationRuleConfigurator.prototype.notNull = function () {
        return this.setValidator(new not_null_validator_1.NotNullValidator());
    };
    /**
     * Defines a 'null' validator on the current rule.
     * Validation will fail if the property is not null and not undefined.
     */
    ValidationRuleConfigurator.prototype.null = function () {
        return this.setValidator(new null_validator_1.NullValidator());
    };
    /**
     * Defines a 'phone' validator on the current rule.
     * Validation will fail if the property is not a well-formed phone number.
     */
    ValidationRuleConfigurator.prototype.phone = function () {
        return this.setValidator(new phone_validator_1.PhoneValidator());
    };
    /**
     * Defines a 'predicate' validator on the current rule.
     * Validation will fail if the specified function or lambda returns false.
     * @param predicate A function or lambda expression specifying the predicate.
     */
    ValidationRuleConfigurator.prototype.must = function (predicate) {
        return this.setValidator(new predicate_validator_1.PredicateValidator(predicate));
    };
    /**
     * Defines a 'regular expression' validator on the current rule.
     * The validation will fail if the property does not match the regular expression.
     * @param regularExpression The regular expression to check the value against.
     */
    ValidationRuleConfigurator.prototype.regularExpression = function (regularExpression) {
        return this.setValidator(new regular_expression_validator_1.RegularExpressionValidator(regularExpression));
    };
    /**
     * Defines an 'uri' validator on the current rule.
     * Validation will fail if the property is not a well-formed URI.
     */
    ValidationRuleConfigurator.prototype.uri = function () {
        return this.setValidator(new uri_validator_1.UriValidator());
    };
    return ValidationRuleConfigurator;
}());
exports.ValidationRuleConfigurator = ValidationRuleConfigurator;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy92YWxpZGF0aW9uLXJ1bGUtY29uZmlndXJhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFFQSxtQ0FBa0MsaUNBQWlDLENBQUMsQ0FBQTtBQUNwRSxzQ0FBb0Msb0NBQW9DLENBQUMsQ0FBQTtBQUN6RSxnQ0FBK0IsOEJBQThCLENBQUMsQ0FBQTtBQUU5RCxnQ0FBK0IsOEJBQThCLENBQUMsQ0FBQTtBQUM5RCx1Q0FBcUMscUNBQXFDLENBQUMsQ0FBQTtBQUMzRSw0Q0FBMEMsMENBQTBDLENBQUMsQ0FBQTtBQUNyRixnREFBNEMsOENBQThDLENBQUMsQ0FBQTtBQUMzRix1Q0FBcUMscUNBQXFDLENBQUMsQ0FBQTtBQUMzRSw0Q0FBMEMsMENBQTBDLENBQUMsQ0FBQTtBQUNyRiw2Q0FBeUMsMkNBQTJDLENBQUMsQ0FBQTtBQUNyRixvQ0FBa0Msa0NBQWtDLENBQUMsQ0FBQTtBQUNyRSxxQ0FBbUMsbUNBQW1DLENBQUMsQ0FBQTtBQUN2RSxxQ0FBbUMsbUNBQW1DLENBQUMsQ0FBQTtBQUN2RSxvQ0FBa0Msa0NBQWtDLENBQUMsQ0FBQTtBQUNyRSxvQ0FBa0Msa0NBQWtDLENBQUMsQ0FBQTtBQUNyRSxtQ0FBaUMsaUNBQWlDLENBQUMsQ0FBQTtBQUNuRSwrQkFBOEIsNkJBQTZCLENBQUMsQ0FBQTtBQUM1RCxnQ0FBK0IsOEJBQThCLENBQUMsQ0FBQTtBQUM5RCxvQ0FBbUMsa0NBQWtDLENBQUMsQ0FBQTtBQUV0RSw2Q0FBMkMsMkNBQTJDLENBQUMsQ0FBQTtBQUN2Riw4QkFBNkIsNEJBQTRCLENBQUMsQ0FBQTtBQUUxRCxvRUFBb0U7QUFDcEU7SUFHSTs7O09BR0c7SUFDSCxvQ0FBWSxJQUFvQztRQUM1QyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztJQUN0QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0kseUNBQUksR0FBWCxVQUFZLFNBQTJDO1FBQ25ELElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFT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Q0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7SUFDaEYsQ0FBQztJQUVEOzs7T0FHRztJQUNJLHdDQUFHLEdBQVY7UUFDSSxNQUFNLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLDRCQUFZLEVBQUUsQ0FBQyxDQUFDO0lBQ2pELENBQUM7SUFDTCxpQ0FBQztBQUFELENBclFBLEFBcVFDLElBQUE7QUFyUVksa0NBQTBCLDZCQXFRdEMsQ0FBQSIsImZpbGUiOiJzcmMvdmFsaWRhdGlvbi1ydWxlLWNvbmZpZ3VyYXRvci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZhbGlkYXRpb25SdWxlIH0gZnJvbSBcIi4vdmFsaWRhdGlvbi1ydWxlXCI7XHJcbmltcG9ydCB7IFZhbGlkYXRvciB9IGZyb20gXCIuL3ZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eVZhbGlkYXRvciB9IGZyb20gXCIuL3ZhbGlkYXRvcnMvcHJvcGVydHktdmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IENyZWRpdENhcmRWYWxpZGF0b3IgfSBmcm9tIFwiLi92YWxpZGF0b3JzL2NyZWRpdC1jYXJkLnZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBFbWFpbFZhbGlkYXRvciB9IGZyb20gXCIuL3ZhbGlkYXRvcnMvZW1haWwudmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IEVtcHR5VmFsaWRhdG9yIH0gZnJvbSBcIi4vdmFsaWRhdG9ycy9lbXB0eS52YWxpZGF0b3JcIjtcclxuaW1wb3J0IHsgRXF1YWxWYWxpZGF0b3IgfSBmcm9tIFwiLi92YWxpZGF0b3JzL2VxdWFsLnZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBFeGFjdExlbmd0aFZhbGlkYXRvciB9IGZyb20gXCIuL3ZhbGlkYXRvcnMvZXhhY3QtbGVuZ3RoLnZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBFeGNsdXNpdmVCZXR3ZWVuVmFsaWRhdG9yIH0gZnJvbSBcIi4vdmFsaWRhdG9ycy9leGNsdXNpdmUtYmV0d2Vlbi52YWxpZGF0b3JcIjtcclxuaW1wb3J0IHsgR3JlYXRlclRoYW5PckVxdWFsVmFsaWRhdG9yIH0gZnJvbSBcIi4vdmFsaWRhdG9ycy9ncmVhdGVyLXRoYW4tb3ItZXF1YWwudmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IEdyZWF0ZXJUaGFuVmFsaWRhdG9yIH0gZnJvbSBcIi4vdmFsaWRhdG9ycy9ncmVhdGVyLXRoYW4udmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IEluY2x1c2l2ZUJldHdlZW5WYWxpZGF0b3IgfSBmcm9tIFwiLi92YWxpZGF0b3JzL2luY2x1c2l2ZS1iZXR3ZWVuLnZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBMZXNzVGhhbk9yRXF1YWxWYWxpZGF0b3IgfSBmcm9tIFwiLi92YWxpZGF0b3JzL2xlc3MtdGhhbi1vci1lcXVhbC52YWxpZGF0b3JcIjtcclxuaW1wb3J0IHsgTGVzc1RoYW5WYWxpZGF0b3IgfSBmcm9tIFwiLi92YWxpZGF0b3JzL2xlc3MtdGhhbi52YWxpZGF0b3JcIjtcclxuaW1wb3J0IHsgTWF4TGVuZ3RoVmFsaWRhdG9yIH0gZnJvbSBcIi4vdmFsaWRhdG9ycy9tYXgtbGVuZ3RoLnZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBNaW5MZW5ndGhWYWxpZGF0b3IgfSBmcm9tIFwiLi92YWxpZGF0b3JzL21pbi1sZW5ndGgudmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IE5vdEVtcHR5VmFsaWRhdG9yIH0gZnJvbSBcIi4vdmFsaWRhdG9ycy9ub3QtZW1wdHkudmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IE5vdEVxdWFsVmFsaWRhdG9yIH0gZnJvbSBcIi4vdmFsaWRhdG9ycy9ub3QtZXF1YWwudmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IE5vdE51bGxWYWxpZGF0b3IgfSBmcm9tIFwiLi92YWxpZGF0b3JzL25vdC1udWxsLnZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBOdWxsVmFsaWRhdG9yIH0gZnJvbSBcIi4vdmFsaWRhdG9ycy9udWxsLnZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBQaG9uZVZhbGlkYXRvciB9IGZyb20gXCIuL3ZhbGlkYXRvcnMvcGhvbmUudmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IFByZWRpY2F0ZVZhbGlkYXRvciB9IGZyb20gXCIuL3ZhbGlkYXRvcnMvcHJlZGljYXRlLnZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBSYW5nZVZhbGlkYXRvciB9IGZyb20gXCIuL3ZhbGlkYXRvcnMvcmFuZ2UudmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IFJlZ3VsYXJFeHByZXNzaW9uVmFsaWRhdG9yIH0gZnJvbSBcIi4vdmFsaWRhdG9ycy9yZWd1bGFyLWV4cHJlc3Npb24udmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IFVyaVZhbGlkYXRvciB9IGZyb20gXCIuL3ZhbGlkYXRvcnMvdXJpLnZhbGlkYXRvclwiO1xyXG5cclxuLyoqIEhlbHBlciBjbGFzcyB0aGF0IGNhbiBiZSB1c2VkIHRvIGNvbmZpZ3VyZSBhIHZhbGlkYXRpb24gcnVsZS4gKi9cclxuZXhwb3J0IGNsYXNzIFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICBwcml2YXRlIF9ydWxlOiBWYWxpZGF0aW9uUnVsZTxUSW5zdGFuY2UsIGFueT47XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWFsaXplcyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgVmFsaWRhdGlvblJ1bGVDb25maWd1cmF0b3IgY2xhc3MuXHJcbiAgICAgKiBAcGFyYW0gcnVsZSBSdWxlIHRvIGJlIGNvbmZpZ3VyZWQuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHJ1bGU6IFZhbGlkYXRpb25SdWxlPFRJbnN0YW5jZSwgYW55Pikge1xyXG4gICAgICAgIHRoaXMuX3J1bGUgPSBydWxlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0KFhbiBiZSB1c2VkIHRvIHNwZWNpZnkgY29uZGl0aW9uIHRoYXQgY29udHJvbCB3aGVuIHRoZSBydWxlIHNob3VsZCBleGVjdXRlLlxyXG4gICAgICogQHBhcmFtIHByZWRpY2F0ZSBDb25kaXRpb24uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB3aGVuKHByZWRpY2F0ZTogKGluc3RhbmNlOiBUSW5zdGFuY2UpID0+IGJvb2xlYW4pOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIHRoaXMuX3J1bGUud2hlbi5wdXNoKHByZWRpY2F0ZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTcGVjaWZpZXMgYSBjdXN0b20gZXJyb3IgbWVzc2FnZSB0byB1c2UgaWYgdmFsaWRhdGlvbiBmYWlscy5cclxuICAgICAqIEBwYXJhbSBlcnJvck1lc3NhZ2UgVGhlIGVycm9yIG1lc3NhZ2UgdG8gdXNlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgd2l0aE1lc3NhZ2UoZXJyb3JNZXNzYWdlOiBzdHJpbmcpOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIGlmICh0aGlzLl9ydWxlLnByb3BlcnR5VmFsaWRhdG9ycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3J1bGUucHJvcGVydHlWYWxpZGF0b3JzW3RoaXMuX3J1bGUucHJvcGVydHlWYWxpZGF0b3JzLmxlbmd0aCAtIDFdLmVycm9yTWVzc2FnZSA9IGVycm9yTWVzc2FnZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aHJvdyBcIkNhbid0IHNldCBlcnJvciBtZXNzYWdlOiB2YWxpZGF0b3IgbGlzdCBpcyBlbXB0eS5cIjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNwZWNpZmllcyBhIGN1c3RvbSBlcnJvciBtZXNzYWdlIHJlc291cmNlIHRvIHVzZSB3aGVuIHZhbGlkYXRpb24gZmFpbHMuXHJcbiAgICAgKiBAcGFyYW0gcmVzb3VyY2VOYW1lIFRoZSByZXNvdXJjZSB0byB1c2UuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB3aXRoTG9jYWxpemVkTWVzc2FnZShyZXNvdXJjZU5hbWU6IHN0cmluZyk6IFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3J1bGUucHJvcGVydHlWYWxpZGF0b3JzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5fcnVsZS5wcm9wZXJ0eVZhbGlkYXRvcnNbdGhpcy5fcnVsZS5wcm9wZXJ0eVZhbGlkYXRvcnMubGVuZ3RoIC0gMV0uZXJyb3JNZXNzYWdlUmVzb3VyY2VOYW1lID0gcmVzb3VyY2VOYW1lO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRocm93IFwiQ2FuJ3Qgc2V0IGVycm9yIG1lc3NhZ2U6IHZhbGlkYXRvciBsaXN0IGlzIGVtcHR5LlwiO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3BlY2lmaWVzIGEgY3VzdG9tIHByb3BlcnR5IG5hbWUgdG8gdXNlIHdpdGhpbiB0aGUgZXJyb3IgbWVzc2FnZS5cclxuICAgICAqIEBwYXJhbSBuYW1lIEN1c3RvbSBwcm9wZXJ0eSBuYW1lIHRvIHVzZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHdpdGhOYW1lKG5hbWU6IHN0cmluZyk6IFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICAgICAgdGhpcy5fcnVsZS5wcm9wZXJ0eURpc3BsYXlOYW1lID0gbmFtZTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYSBjdXN0b20gdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUgYnVpbGRlci5cclxuICAgICAqIEBwYXJhbSB2YWxpZGF0b3IgUHJvcGVydHkgb3Igb2JqZWN0IHZhbGlkYXRvciBpbnN0YW5jZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldFZhbGlkYXRvcih2YWxpZGF0b3I6IFZhbGlkYXRvcjxUUHJvcGVydHk+IHwgUHJvcGVydHlWYWxpZGF0b3IpOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIGlmICh2YWxpZGF0b3IgaW5zdGFuY2VvZiBQcm9wZXJ0eVZhbGlkYXRvcikge1xyXG4gICAgICAgICAgICB0aGlzLl9ydWxlLnByb3BlcnR5VmFsaWRhdG9ycy5wdXNoKHZhbGlkYXRvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9ydWxlLnZhbGlkYXRvcnMucHVzaCh2YWxpZGF0b3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYSBjdXN0b20gY29sbGVjdGlvbiB2YWxpZGF0b3Igb24gdGhlIGN1cnJlbnQgcnVsZSBidWlsZGVyLlxyXG4gICAgICogQHBhcmFtIHZhbGlkYXRvciBPYmplY3QgdmFsaWRhdG9yIHRvIGFwcGx5LlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2V0Q29sbGVjdGlvblZhbGlkYXRvcih2YWxpZGF0b3I6IFZhbGlkYXRvcjxhbnk+KTogVmFsaWRhdGlvblJ1bGVDb25maWd1cmF0b3I8VEluc3RhbmNlLCBUUHJvcGVydHk+IHtcclxuICAgICAgICB0aGlzLl9ydWxlLmNvbGxlY3Rpb25WYWxpZGF0b3JzLnB1c2godmFsaWRhdG9yKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYSAnY3JlZGl0IGNhcmQnIHZhbGlkYXRvciBvbiB0aGUgY3VycmVudCBydWxlLiBcclxuICAgICAqIFZhbGlkYXRpb24gd2lsbCBmYWlsIGlmIHRoZSBwcm9wZXJ0eSBpcyBub3QgYSBjcmVkaXQgY2FyZCBudW1iZXIuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjcmVkaXRDYXJkKCk6IFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0VmFsaWRhdG9yKG5ldyBDcmVkaXRDYXJkVmFsaWRhdG9yKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVmaW5lcyBhbiAnZW1haWwnIHZhbGlkYXRvciBvbiB0aGUgY3VycmVudCBydWxlLiBcclxuICAgICAqIFZhbGlkYXRpb24gd2lsbCBmYWlsIGlmIHRoZSBwcm9wZXJ0eSBpcyBub3QgYW4gZW1haWwgYWRkcmVzcy5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGVtYWlsKCk6IFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0VmFsaWRhdG9yKG5ldyBFbWFpbFZhbGlkYXRvcigpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYW4gJ2VtcHR5JyB2YWxpZGF0b3Igb24gdGhlIGN1cnJlbnQgcnVsZS4gXHJcbiAgICAgKiBWYWxpZGF0aW9uIHdpbGwgZmFpbCBpZiB0aGUgcHJvcGVydHkgaXMgbm90IG51bGwsIG5vdCB1bmRlZmluZWQsIG5vdCB3aGl0ZXNwYWNlLCBub3QgemVybyBhbmQgbm90IGFuIGVtcHR5IGFycmF5LlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZW1wdHkoKTogVmFsaWRhdGlvblJ1bGVDb25maWd1cmF0b3I8VEluc3RhbmNlLCBUUHJvcGVydHk+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXRWYWxpZGF0b3IobmV3IE5vdE51bGxWYWxpZGF0b3IoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWZpbmVzIGFuICdlcXVhbCcgdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUuIFxyXG4gICAgICogVmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHNwZWNpZmllZCB2YWx1ZSBpcyBub3QgZXF1YWwgdG8gdGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGVxdWFsKHZhbHVlVG9Db21wYXJlOiBhbnkpOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldFZhbGlkYXRvcihuZXcgRXF1YWxWYWxpZGF0b3IodmFsdWVUb0NvbXBhcmUpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYW4gJ2V4YWN0IGxlbmd0aCcgdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUuIFxyXG4gICAgICogVmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIGxlbmd0aCBvZiB0aGUgc3RyaW5nIGlzIG5vdCBlcXVhbCB0byB0aGUgbGVuZ3RoIHNwZWNpZmllZC5cclxuICAgICAqIEBwYXJhbSBsZW5ndGggRXhhY3QgbGVuZ3RoLiBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGV4YWN0TGVuZ3RoKGxlbmd0aDogbnVtYmVyKTogVmFsaWRhdGlvblJ1bGVDb25maWd1cmF0b3I8VEluc3RhbmNlLCBUUHJvcGVydHk+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXRWYWxpZGF0b3IobmV3IEV4YWN0TGVuZ3RoVmFsaWRhdG9yKGxlbmd0aCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVmaW5lcyBhICdleGNsdXNpdmUgYmV0d2VlbicgdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUuIFxyXG4gICAgICogVmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eSBpcyBvdXRzaWRlIG9mIHRoZSBzcGVjaWZlZCByYW5nZS4gVGhlIHJhbmdlIGlzIGV4Y2x1c2l2ZS5cclxuICAgICAqIEBwYXJhbSBtaW4gTWluaW11bSB2YWx1ZS4gXHJcbiAgICAgKiBAcGFyYW0gbWF4IE1heGltdW0gdmFsdWUuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBleGNsdXNpdmVCZXR3ZWVuKG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0VmFsaWRhdG9yKG5ldyBFeGNsdXNpdmVCZXR3ZWVuVmFsaWRhdG9yKG1pbiwgbWF4KSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWZpbmVzIGEgJ2dyZWF0ZXIgdGhhbicgdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUuIFxyXG4gICAgICogVGhlIHZhbGlkYXRpb24gd2lsbCBmYWlsIGlmIHRoZSBwcm9wZXJ0eSB2YWx1ZSBpcyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHNwZWNpZmllZCB2YWx1ZS5cclxuICAgICAqIEBwYXJhbSBtaW4gTWluaW11bSB2YWx1ZS4gXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBncmVhdGVyVGhhbihtaW46IG51bWJlcik6IFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0VmFsaWRhdG9yKG5ldyBHcmVhdGVyVGhhblZhbGlkYXRvcihtaW4pKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYSAnZ3JlYXRlciB0aGFuIG9yIGVxdWFsJyB2YWxpZGF0b3Igb24gdGhlIGN1cnJlbnQgcnVsZS4gXHJcbiAgICAgKiBUaGUgdmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHByb3BlcnR5IHZhbHVlIGlzIGxlc3MgdGhhbiB0aGUgc3BlY2lmaWVkIHZhbHVlLlxyXG4gICAgICogQHBhcmFtIG1pbiBNaW5pbXVtIHZhbHVlLiBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdyZWF0ZXJUaGFuT3JFcXVhbChtaW46IG51bWJlcik6IFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0VmFsaWRhdG9yKG5ldyBHcmVhdGVyVGhhbk9yRXF1YWxWYWxpZGF0b3IobWluKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWZpbmVzIGEgJ2luY2x1c2l2ZSBiZXR3ZWVuJyB2YWxpZGF0b3Igb24gdGhlIGN1cnJlbnQgcnVsZS4gXHJcbiAgICAgKiBWYWxpZGF0aW9uIHdpbGwgZmFpbCBpZiB0aGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5IGlzIG91dHNpZGUgb2YgdGhlIHNwZWNpZmVkIHJhbmdlLiBUaGUgcmFuZ2UgaXMgaW5jbHVzaXZlLlxyXG4gICAgICogQHBhcmFtIG1pbiBNaW5pbXVtIHZhbHVlLiBcclxuICAgICAqIEBwYXJhbSBtYXggTWF4aW11bSB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGluY2x1c2l2ZUJldHdlZW4obWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogVmFsaWRhdGlvblJ1bGVDb25maWd1cmF0b3I8VEluc3RhbmNlLCBUUHJvcGVydHk+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXRWYWxpZGF0b3IobmV3IEluY2x1c2l2ZUJldHdlZW5WYWxpZGF0b3IobWluLCBtYXgpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYSAnbGVzcyB0aGFuJyB2YWxpZGF0b3Igb24gdGhlIGN1cnJlbnQgcnVsZS4gXHJcbiAgICAgKiBUaGUgdmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHByb3BlcnR5IHZhbHVlIGlzIG1vcmUgdGhhbiBvciBlcXVhbCB0byB0aGUgc3BlY2lmaWVkIHZhbHVlLlxyXG4gICAgICogQHBhcmFtIG1heCBNYXhpbXVtIHZhbHVlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbGVzc1RoYW4obWF4OiBudW1iZXIpOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldFZhbGlkYXRvcihuZXcgTGVzc1RoYW5WYWxpZGF0b3IobWF4KSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWZpbmVzIGEgJ2xlc3MgdGhhbiBvciBlcXVhbCcgdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUuIFxyXG4gICAgICogVGhlIHZhbGlkYXRpb24gd2lsbCBmYWlsIGlmIHRoZSBwcm9wZXJ0eSB2YWx1ZSBpcyBtb3JlIHRoYW4gdGhlIHNwZWNpZmllZCB2YWx1ZS5cclxuICAgICAqIEBwYXJhbSBtYXggTWF4aW11bSB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGxlc3NUaGFuT3JFcXVhbChtYXg6IG51bWJlcik6IFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0VmFsaWRhdG9yKG5ldyBMZXNzVGhhbk9yRXF1YWxWYWxpZGF0b3IobWF4KSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWZpbmVzIGEgJ21heGltdW0gbGVuZ3RoJyB2YWxpZGF0b3Igb24gdGhlIGN1cnJlbnQgcnVsZS5cclxuICAgICAqIFZhbGlkYXRpb24gd2lsbCBmYWlsIGlmIHRoZSBsZW5ndGggb2YgdGhlIHN0cmluZyBpcyBtb3JlIHRoYW4gdGhlIHNwZWNpZmllZCB2YWx1ZS5cclxuICAgICAqIEBwYXJhbSBtYXhMZW5ndGggTWF4aW11bSBsZW5ndGguXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBtYXhMZW5naHQobWF4TGVuZ3RoOiBudW1iZXIpOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIHRoaXMuc2V0VmFsaWRhdG9yKG5ldyBNYXhMZW5ndGhWYWxpZGF0b3IobWF4TGVuZ3RoKSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWZpbmVzIGEgJ21pbmltdW0gbGVuZ3RoJyB2YWxpZGF0b3Igb24gdGhlIGN1cnJlbnQgcnVsZS5cclxuICAgICAqIFZhbGlkYXRpb24gd2lsbCBmYWlsIGlmIHRoZSBsZW5ndGggb2YgdGhlIHN0cmluZyBpcyBsZXNzIHRoYW4gdGhlIHNwZWNpZmllZCB2YWx1ZS5cclxuICAgICAqIEBwYXJhbSBtYXhMZW5ndGggTWF4aW11bSBsZW5ndGguXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBtaW5MZW5naHQobWluTGVuZ3RoOiBudW1iZXIpOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIHRoaXMuc2V0VmFsaWRhdG9yKG5ldyBNaW5MZW5ndGhWYWxpZGF0b3IobWluTGVuZ3RoKSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWZpbmVzIGFuICdub3QgZW1wdHknIHZhbGlkYXRvciBvbiB0aGUgY3VycmVudCBydWxlLiBcclxuICAgICAqIFZhbGlkYXRpb24gd2lsbCBmYWlsIGlmIHRoZSBwcm9wZXJ0eSBpcyBudWxsLCB1bmRlZmluZWQsIHdoaXRlc3BhY2UsIHplcm8gb3IgYW4gZW1wdHkgYXJyYXkuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBub3RFbXB0eSgpOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldFZhbGlkYXRvcihuZXcgTm90RW1wdHlWYWxpZGF0b3IoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWZpbmVzIGEgJ25vdCBlcXVhbCcgdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUuIFxyXG4gICAgICogVmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHNwZWNpZmllZCB2YWx1ZSBpcyBlcXVhbCB0byB0aGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5LlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbm90RXF1YWwodmFsdWVUb0NvbXBhcmU6IGFueSk6IFZhbGlkYXRpb25SdWxlQ29uZmlndXJhdG9yPFRJbnN0YW5jZSwgVFByb3BlcnR5PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0VmFsaWRhdG9yKG5ldyBOb3RFcXVhbFZhbGlkYXRvcih2YWx1ZVRvQ29tcGFyZSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVmaW5lcyBhICdub3QgbnVsbCcgdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUuIFxyXG4gICAgICogVmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHByb3BlcnR5IGlzIG51bGwgb3IgdW5kZWZpbmVkLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbm90TnVsbCgpOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldFZhbGlkYXRvcihuZXcgTm90TnVsbFZhbGlkYXRvcigpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYSAnbnVsbCcgdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUuIFxyXG4gICAgICogVmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHByb3BlcnR5IGlzIG5vdCBudWxsIGFuZCBub3QgdW5kZWZpbmVkLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbnVsbCgpOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldFZhbGlkYXRvcihuZXcgTnVsbFZhbGlkYXRvcigpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYSAncGhvbmUnIHZhbGlkYXRvciBvbiB0aGUgY3VycmVudCBydWxlLiBcclxuICAgICAqIFZhbGlkYXRpb24gd2lsbCBmYWlsIGlmIHRoZSBwcm9wZXJ0eSBpcyBub3QgYSB3ZWxsLWZvcm1lZCBwaG9uZSBudW1iZXIuIFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcGhvbmUoKTogVmFsaWRhdGlvblJ1bGVDb25maWd1cmF0b3I8VEluc3RhbmNlLCBUUHJvcGVydHk+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXRWYWxpZGF0b3IobmV3IFBob25lVmFsaWRhdG9yKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVmaW5lcyBhICdwcmVkaWNhdGUnIHZhbGlkYXRvciBvbiB0aGUgY3VycmVudCBydWxlLlxyXG4gICAgICogVmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHNwZWNpZmllZCBmdW5jdGlvbiBvciBsYW1iZGEgcmV0dXJucyBmYWxzZS5cclxuICAgICAqIEBwYXJhbSBwcmVkaWNhdGUgQSBmdW5jdGlvbiBvciBsYW1iZGEgZXhwcmVzc2lvbiBzcGVjaWZ5aW5nIHRoZSBwcmVkaWNhdGUuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBtdXN0KHByZWRpY2F0ZTogKHByb3BlcnR5OiBUUHJvcGVydHksIGluc3RhbmNlPzogVEluc3RhbmNlKSA9PiBib29sZWFuKTogVmFsaWRhdGlvblJ1bGVDb25maWd1cmF0b3I8VEluc3RhbmNlLCBUUHJvcGVydHk+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXRWYWxpZGF0b3IobmV3IFByZWRpY2F0ZVZhbGlkYXRvcihwcmVkaWNhdGUpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYSAncmVndWxhciBleHByZXNzaW9uJyB2YWxpZGF0b3Igb24gdGhlIGN1cnJlbnQgcnVsZS4gXHJcbiAgICAgKiBUaGUgdmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHByb3BlcnR5IGRvZXMgbm90IG1hdGNoIHRoZSByZWd1bGFyIGV4cHJlc3Npb24uXHJcbiAgICAgKiBAcGFyYW0gcmVndWxhckV4cHJlc3Npb24gVGhlIHJlZ3VsYXIgZXhwcmVzc2lvbiB0byBjaGVjayB0aGUgdmFsdWUgYWdhaW5zdC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlZ3VsYXJFeHByZXNzaW9uKHJlZ3VsYXJFeHByZXNzaW9uOiBSZWdFeHApOiBWYWxpZGF0aW9uUnVsZUNvbmZpZ3VyYXRvcjxUSW5zdGFuY2UsIFRQcm9wZXJ0eT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldFZhbGlkYXRvcihuZXcgUmVndWxhckV4cHJlc3Npb25WYWxpZGF0b3IocmVndWxhckV4cHJlc3Npb24pKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlZmluZXMgYW4gJ3VyaScgdmFsaWRhdG9yIG9uIHRoZSBjdXJyZW50IHJ1bGUuIFxyXG4gICAgICogVmFsaWRhdGlvbiB3aWxsIGZhaWwgaWYgdGhlIHByb3BlcnR5IGlzIG5vdCBhIHdlbGwtZm9ybWVkIFVSSS4gXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB1cmkoKTogVmFsaWRhdGlvblJ1bGVDb25maWd1cmF0b3I8VEluc3RhbmNlLCBUUHJvcGVydHk+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZXRWYWxpZGF0b3IobmV3IFVyaVZhbGlkYXRvcigpKTtcclxuICAgIH1cclxufSJdfQ==
